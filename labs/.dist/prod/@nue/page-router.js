async function G(v){dispatchEvent(new Event("before:route"));const D=V(await U(v));document.title=z("title",D)?.textContent,J(B("style"),B("style",D)).forEach((x)=>z("head").appendChild(x)),z("body").classList=z("body2",D).classList;const j=J(B("link"),B("link",D));W(j,()=>{O(D),K(v),scrollTo(0,0),dispatchEvent(new Event("route"))})}var O=function(v){for(let D of["header","main","footer"]){const E=z("body >"+D),j=z("body2 >"+D,v);if(E&&j){if(E.outerHTML!=j.outerHTML)E.replaceWith(j)}else if(E)E.remove();else if(j){const x=D=="footer"?"append":"prepend";document.body[x](j)}}};function Q(v,D){v.addEventListener("click",(E)=>{const j=E.target.closest("[href]"),x=j?.getAttribute("href"),N=j?.getAttribute("target");if(E.defaultPrevented||E.metaKey||E.ctrlKey||E.shiftKey||E.altKey||!x||x[0]=="#"||x.includes("//")||x.startsWith("mailto:")||N=="_blank")return;if(x!=location.pathname)D(x);E.preventDefault()})}function K(v,D="active"){B(`[${D}]`).forEach((E)=>E.removeAttribute(D)),B(`[href="${v}"]`).forEach((E)=>E.toggleAttribute(D,!0))}var z=function(v,D=document){return D.querySelector(v)},B=function(v,D=document){return[...D.querySelectorAll(v)]},I=function(v,D){return D.find((E)=>E.getAttribute("href")==v.getAttribute("href"))},J=function(v,D){return v.forEach((E,j)=>E.disabled=!I(E,D)),D.filter((E)=>!I(E,v))};async function U(v){if(!F[v]){const D=await fetch(v);F[v]=await D.text()}return F[v]}var V=function(v){v=v.replace(/<(\/?)body/g,"<$1body2");const D=document.createElement("template");return D.innerHTML=v.trim(),D.content},W=function(v,D){let E=0;!v[0]?D():v.forEach((j,x)=>{X(j.href,()=>{if(++E==v.length)D()})})},X=function(v,D){const E=document.createElement("link");E.rel="stylesheet",E.href=v,z("head").appendChild(E),E.onload=D},R=typeof window=="object";if(R){if(!document.startViewTransition)document.startViewTransition=(v)=>v();history.pushState({path:location.pathname},0),Q(document,async(v)=>{document.startViewTransition(async function(){await G(v),history.pushState({path:v},0,v)})}),K(location.pathname),addEventListener("popstate",(v)=>{const{path:D}=v.state||{};if(D)G(D)})}var F={};export{K as setActive,Q as onclick,G as loadPage};
